â!
xD:\FII-2024-2025\.NET\PROIECT\Predictive-Healthcare-Management-System\Predictive-Healthcare-Management-System\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder		 
.		 
Services		 
.		 
AddApplication		 
(		  
)		  !
;		! "
builder

 
.

 
Services

 
.

 
AddInfrastructure

 "
(

" #
builder

# *
.

* +
Configuration

+ 8
)

8 9
;

9 :
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddDbContext 
<  
ApplicationDbContext 2
>2 3
(3 4
options4 ;
=>< >
options 
. 
	UseNpgsql 
( 
builder 
. 
Configuration +
.+ ,
GetConnectionString, ?
(? @
$str@ S
)S T
,T U
b 	
=>
 
b 
. 
MigrationsAssembly !
(! "
$str" 2
)2 3
)3 4
)4 5
;5 6
builder 
. 
Services 
. 
	AddScoped 
< "
IAppointmentRepository 1
,1 2!
AppointmentRepository3 H
>H I
(I J
)J K
;K L
builder 
. 
Services 
. 
	AddScoped 
< 
IPatientRepository -
,- .
PatientRepository/ @
>@ A
(A B
)B C
;C D
builder 
. 
Services 
. 
AddCors 
( 
options  
=>! #
{ 
options 
. 
	AddPolicy 
( 
$str  
,  !
builder" )
=>* ,
{ 
builder 
. 
AllowAnyOrigin 
( 
)  
. 
AllowAnyMethod 
( 
)  
. 
AllowAnyHeader 
( 
)  
;  !
} 
) 
; 
} 
) 
; 
builder!! 
.!! 
Services!! 
.!! #
AddEndpointsApiExplorer!! (
(!!( )
)!!) *
;!!* +
builder"" 
."" 
Services"" 
."" 
AddSwaggerGen"" 
("" 
)""  
;""  !
var$$ 
app$$ 
=$$ 	
builder$$
 
.$$ 
Build$$ 
($$ 
)$$ 
;$$ 
if'' 
('' 
app'' 
.'' 
Environment'' 
.'' 
IsDevelopment'' !
(''! "
)''" #
)''# $
{(( 
app)) 
.)) 

UseSwagger)) 
()) 
))) 
;)) 
app** 
.** 
UseSwaggerUI** 
(** 
)** 
;** 
},, 
if// 
(// 
!// 
app// 
.// 	
Environment//	 
.// 
IsDevelopment// "
(//" #
)//# $
)//$ %
{00 
app11 
.11 
UseExceptionHandler11 
(11 
$str11 $
)11$ %
;11% &
}22 
app44 
.44 
UseHttpsRedirection44 
(44 
)44 
;44 
app66 
.66 
UseCors66 
(66 
$str66 
)66 
;66 
app88 
.88 
UseAuthorization88 
(88 
)88 
;88 
app:: 
.:: 
MapControllers:: 
(:: 
):: 
;:: 
app<< 
.<< 
Run<< 
(<< 
)<< 	
;<<	 
Ó1
D:\FII-2024-2025\.NET\PROIECT\Predictive-Healthcare-Management-System\Predictive-Healthcare-Management-System\Controllers\PatientsController.cs
	namespace 	3
'Predictive_Healthcare_Management_System
 1
.1 2
Controllers2 =
{ 
[		 
Route		 

(		
 
$str		  
)		  !
]		! "
[

 
ApiController

 
]

 
public 

class 
PatientsController #
:$ %
ControllerBase& 4
{ 
private 
readonly 
	IMediator "
	_mediator# ,
;, -
public 
PatientsController !
(! "
	IMediator" +
mediator, 4
)4 5
{ 	
	_mediator 
= 
mediator  
;  !
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAll) /
(/ 0
)0 1
{ 	
var 
result 
= 
await 
	_mediator (
.( )
Send) -
(- .
new. 1
GetPatientsQuery2 B
(B C
)C D
)D E
;E F
return 
Ok 
( 
result 
) 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '

PatientDTO' 1
>1 2
>2 3
GetById4 ;
(; <
Guid< @
idA C
)C D
{ 	
var 
patient 
= 
await 
	_mediator  )
.) *
Send* .
(. /
new/ 2
GetPatientByIdQuery3 F
{G H
IdI K
=L M
idN P
}Q R
)R S
;S T
if 
( 
patient 
== 
null 
)  
{   
throw!! 
new!! 
NotFoundException!! +
(!!+ ,
)!!, -
;!!- .
}"" 
return## 
Ok## 
(## 
patient## 
)## 
;## 
}$$ 	
[&& 	
HttpPost&&	 
]&& 
public'' 
async'' 
Task'' 
<'' 
IActionResult'' '
>''' (
Create'') /
(''/ 0 
CreatePatientCommand''0 D
command''E L
)''L M
{(( 	
var)) 
	patientId)) 
=)) 
await)) !
	_mediator))" +
.))+ ,
Send)), 0
())0 1
command))1 8
)))8 9
;))9 :
return** 
CreatedAtAction** "
(**" #
nameof**# )
(**) *
GetById*** 1
)**1 2
,**2 3
new**4 7
{**8 9
id**: <
=**= >
	patientId**? H
}**I J
,**J K
new**L O
{**P Q
id**R T
=**U V
	patientId**W `
}**a b
)**b c
;**c d
}++ 	
[-- 	

HttpDelete--	 
(-- 
$str-- 
)-- 
]-- 
public.. 
async.. 
Task.. 
<.. 
IActionResult.. '
>..' (
Delete..) /
(../ 0
Guid..0 4
id..5 7
)..7 8
{// 	
var00 
patient00 
=00 
await00 
	_mediator00  )
.00) *
Send00* .
(00. /
new00/ 2
GetPatientByIdQuery003 F
{00G H
Id00I K
=00L M
id00N P
}00Q R
)00R S
;00S T
if11 
(11 
patient11 
==11 
null11 
)11  
{22 
throw33 
new33 
NotFoundException33 +
(33+ ,
)33, -
;33- .
}44 
await55 
	_mediator55 
.55 
Send55  
(55  !
new55! $ 
DeletePatientCommand55% 9
{55: ;
Id55< >
=55? @
id55A C
}55D E
)55E F
;55F G
return66 
	NoContent66 
(66 
)66 
;66 
}77 	
[99 	
HttpPut99	 
(99 
$str99 
)99 
]99 
public:: 
async:: 
Task:: 
<:: 
IActionResult:: '
>::' (
Update::) /
(::/ 0
Guid::0 4
id::5 7
,::7 8 
UpdatePatientCommand::9 M
command::N U
)::U V
{;; 	
if<< 
(<< 
id<< 
!=<< 
command<< 
.<< 
	PatientId<< '
)<<' (
{== 
Console>> 
.>> 
	WriteLine>> !
(>>! "
id>>" $
.>>$ %
ToString>>% -
(>>- .
)>>. /
,>>/ 0
command>>1 8
.>>8 9
	PatientId>>9 B
)>>B C
;>>C D
throw?? 
new?? 
IdMismatchException?? -
(??- .
)??. /
;??/ 0
}@@ 
varBB 
patientBB 
=BB 
awaitBB 
	_mediatorBB  )
.BB) *
SendBB* .
(BB. /
newBB/ 2
GetPatientByIdQueryBB3 F
{BBG H
IdBBI K
=BBL M
idBBN P
}BBQ R
)BBR S
;BBS T
ifCC 
(CC 
patientCC 
==CC 
nullCC 
)CC  
{DD 
throwEE 
newEE 
NotFoundExceptionEE +
(EE+ ,
)EE, -
;EE- .
}FF 
awaitHH 
	_mediatorHH 
.HH 
SendHH  
(HH  !
commandHH! (
)HH( )
;HH) *
returnII 
	NoContentII 
(II 
)II 
;II 
}JJ 	
}KK 
}LL ø/
”D:\FII-2024-2025\.NET\PROIECT\Predictive-Healthcare-Management-System\Predictive-Healthcare-Management-System\Controllers\MedicalRecordController.cs
	namespace 	3
'Predictive_Healthcare_Management_System
 1
.1 2
Controllers2 =
{ 
[		 
Route		 

(		
 
$str		  
)		  !
]		! "
[

 
ApiController

 
]

 
public 

class #
MedicalRecordController (
:) *
ControllerBase+ 9
{ 
private 
readonly 
	IMediator "
	_mediator# ,
;, -
public #
MedicalRecordController &
(& '
	IMediator' 0
mediator1 9
)9 :
{ 	
	_mediator 
= 
mediator  
;  !
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Create) /
(/ 0&
CreateMedicalRecordCommand0 J
commandK R
)R S
{ 	
var 
recordId 
= 
await  
	_mediator! *
.* +
Send+ /
(/ 0
command0 7
)7 8
;8 9
return 
CreatedAtAction "
(" #
nameof# )
() *
GetById* 1
)1 2
,2 3
new4 7
{8 9
id: <
== >
recordId? G
}H I
,I J
newK N
{O P
idQ S
=T U
recordIdV ^
}_ `
)` a
;a b
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '
MedicalRecordDTO' 7
>7 8
>8 9
GetById: A
(A B
GuidB F
idG I
)I J
{ 	
var 
record 
= 
await 
	_mediator (
.( )
Send) -
(- .
new. 1%
GetMedicalRecordByIdQuery2 K
{L M
IdN P
=Q R
idS U
}V W
)W X
;X Y
if 
( 
record 
== 
null 
) 
{   
return!! 
NotFound!! 
(!!  
)!!  !
;!!! "
}"" 
return## 
Ok## 
(## 
record## 
)## 
;## 
}$$ 	
[&& 	
HttpGet&&	 
]&& 
public'' 
async'' 
Task'' 
<'' 
IActionResult'' '
>''' (
GetAll'') /
(''/ 0
)''0 1
{(( 	
var)) 
result)) 
=)) 
await)) 
	_mediator)) (
.))( )
Send))) -
())- .
new)). 1"
GetMedicalRecordsQuery))2 H
())H I
)))I J
)))J K
;))K L
return** 
Ok** 
(** 
result** 
)** 
;** 
}++ 	
[-- 	

HttpDelete--	 
(-- 
$str-- 
)-- 
]-- 
public.. 
async.. 
Task.. 
<.. 
IActionResult.. '
>..' (
Delete..) /
(../ 0
Guid..0 4
id..5 7
)..7 8
{// 	
var00 
patient00 
=00 
await00 
	_mediator00  )
.00) *
Send00* .
(00. /
new00/ 2%
GetMedicalRecordByIdQuery003 L
{00M N
Id00O Q
=00R S
id00T V
}00W X
)00X Y
;00Y Z
if11 
(11 
patient11 
==11 
null11 
)11  
{22 
throw33 
new33 
NotFoundException33 +
(33+ ,
)33, -
;33- .
}44 
await55 
	_mediator55 
.55 
Send55  
(55  !
new55! $&
DeleteMedicalRecordCommand55% ?
{55@ A
Id55B D
=55E F
id55G I
}55J K
)55K L
;55L M
return66 
	NoContent66 
(66 
)66 
;66 
}77 	
[99 	
HttpPut99	 
(99 
$str99 
)99 
]99 
public:: 
async:: 
Task:: 
<:: 
IActionResult:: '
>::' (
Update::) /
(::/ 0
Guid::0 4
id::5 7
,::7 8&
UpdateMedicalRecordCommand::9 S
command::T [
)::[ \
{;; 	
if<< 
(<< 
id<< 
!=<< 
command<< 
.<< 
RecordId<< &
)<<& '
{== 
throw>> 
new>> 
IdMismatchException>> -
(>>- .
)>>. /
;>>/ 0
}?? 
varAA 
recordAA 
=AA 
awaitAA 
	_mediatorAA (
.AA( )
SendAA) -
(AA- .
newAA. 1%
GetMedicalRecordByIdQueryAA2 K
{AAL M
IdAAN P
=AAQ R
idAAS U
}AAV W
)AAW X
;AAX Y
ifBB 
(BB 
recordBB 
==BB 
nullBB 
)BB 
{CC 
throwDD 
newDD *
MedicalRecordNotFoundExceptionDD 8
(DD8 9
)DD9 :
;DD: ;
}EE 
awaitGG 
	_mediatorGG 
.GG 
SendGG  
(GG  !
commandGG! (
)GG( )
;GG) *
returnHH 
	NoContentHH 
(HH 
)HH 
;HH 
}II 	
}JJ 
}KK Æ!
ŒD:\FII-2024-2025\.NET\PROIECT\Predictive-Healthcare-Management-System\Predictive-Healthcare-Management-System\Controllers\ErrorController.cs
public 
class 
IdMismatchException  
:! "
	Exception# ,
{- .
}/ 0
public 
class 
NotFoundException 
:  
	Exception! *
{+ ,
}- .
public 
class *
MedicalRecordNotFoundException +
:, -
	Exception. 7
{8 9
}: ;
public 
class 
AppointmentNotFound  
:! "
	Exception# ,
{- .
}/ 0
	namespace

 	3
'Predictive_Healthcare_Management_System


 1
.

1 2
Controllers

2 =
{ 
[ 
ApiController 
] 
public 

class 
ErrorController  
:! "
ControllerBase# 1
{ 
[ 	
HttpGet	 
] 
[ 	
Route	 
( 
$str #
)# $
]$ %
public 
IActionResult "
HandleErrorDevelopment 3
(3 4
[4 5
FromServices5 A
]A B
IHostEnvironmentC S
hostEnvironmentT c
)c d
{ 	
if 
( 
! 
hostEnvironment  
.  !
IsDevelopment! .
(. /
)/ 0
)0 1
{ 
return 
NotFound 
(  
)  !
;! "
} 
var #
exceptionHandlerFeature '
=( )
HttpContext* 5
.5 6
Features6 >
.> ?
Get? B
<B C$
IExceptionHandlerFeatureC [
>[ \
(\ ]
)] ^
;^ _
var 
	exception 
= #
exceptionHandlerFeature 3
?3 4
.4 5
Error5 :
;: ;
if 
( 
	exception 
!= 
null !
)! "
{ 
return 
Problem 
( 
detail 
: 
	exception %
.% &

StackTrace& 0
,0 1
title   
:   
GetErrorMessage   *
(  * +
	exception  + 4
)  4 5
)  5 6
;  6 7
}!! 
return## 
Problem## 
(## 
$str## M
)##M N
;##N O
}$$ 	
[&& 	
HttpGet&&	 
]&& 
['' 	
Route''	 
('' 
$str'' 
)'' 
]'' 
public(( 
IActionResult(( 
HandleError(( (
(((( )
)(() *
{)) 	
var** #
exceptionHandlerFeature** '
=**( )
HttpContext*** 5
.**5 6
Features**6 >
.**> ?
Get**? B
<**B C$
IExceptionHandlerFeature**C [
>**[ \
(**\ ]
)**] ^
;**^ _
var++ 
	exception++ 
=++ #
exceptionHandlerFeature++ 3
?++3 4
.++4 5
Error++5 :
;++: ;
return-- 
Problem-- 
(-- 
title--  
:--  !
GetErrorMessage--" 1
(--1 2
	exception--2 ;
)--; <
)--< =
;--= >
}.. 	
private00 
string00 
GetErrorMessage00 &
(00& '
	Exception00' 0
	exception001 :
)00: ;
{11 	
return22 
	exception22 
switch22 #
{33 
AppointmentNotFound44 #
=>44$ &
$str44& N
,44N O
IdMismatchException55 #
=>55$ &
$str55' `
,55` a
NotFoundException66 !
=>66" $
$str66% K
,66K L*
MedicalRecordNotFoundException77 .
=>77/ 1
$str772 _
,77_ `
_88 
=>88 
$str88 4
}99 
;99 
}:: 	
};; 
}<< Â0
’D:\FII-2024-2025\.NET\PROIECT\Predictive-Healthcare-Management-System\Predictive-Healthcare-Management-System\Controllers\AppointmentController.cs
	namespace 	3
'Predictive_Healthcare_Management_System
 1
.1 2
Controllers2 =
{ 
[		 
Route		 

(		
 
$str		  
)		  !
]		! "
[

 
ApiController

 
]

 
public 

class !
AppointmentController &
:' (
ControllerBase) 7
{ 
private 
readonly 
	IMediator "
	_mediator# ,
;, -
public !
AppointmentController $
($ %
	IMediator% .
mediator/ 7
)7 8
{ 	
	_mediator 
= 
mediator  
;  !
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAll) /
(/ 0
)0 1
{ 	
var 
result 
= 
await 
	_mediator (
.( )
Send) -
(- .
new. 1
GetAppointmentQuery2 E
(E F
)F G
)G H
;H I
return 
Ok 
( 
result 
) 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '

PatientDTO' 1
>1 2
>2 3
GetById4 ;
(; <
Guid< @
idA C
)C D
{ 	
var 
result 
= 
await 
	_mediator (
.( )
Send) -
(- .
new. 1#
GetAppointmentByIdQuery2 I
{J K
IdL N
=O P
idQ S
}T U
)U V
;V W
if 
( 
result 
== 
null 
) 
{   
throw!! 
new!! 
AppointmentNotFound!! -
(!!- .
)!!. /
;!!/ 0
}"" 
return## 
Ok## 
(## 
result## 
)## 
;## 
}$$ 	
[&& 	
HttpPost&&	 
]&& 
public'' 
async'' 
Task'' 
<'' 
IActionResult'' '
>''' (
CreateAppointment'') :
('': ;$
CreateAppointmentCommand''; S
command''T [
)''[ \
{(( 	
var22 
appointmentId22 
=22 
await22  %
	_mediator22& /
.22/ 0
Send220 4
(224 5
command225 <
)22< =
;22= >
return33 
CreatedAtAction33 "
(33" #
nameof33# )
(33) *
GetById33* 1
)331 2
,332 3
new334 7
{338 9
id33: <
=33= >
appointmentId33? L
}33M N
,33N O
new33P S
{33T U
id33V X
=33Y Z
appointmentId33[ h
}33i j
)33j k
;33k l
}44 	
[66 	
HttpPut66	 
(66 
$str66 
)66 
]66 
public77 
async77 
Task77 
<77 
IActionResult77 '
>77' (
Update77) /
(77/ 0
Guid770 4
id775 7
,777 8$
UpdateAppointmentCommand779 Q
command77R Y
)77Y Z
{88 	
if99 
(99 
id99 
!=99 
command99 
.99 
AppointmentId99 +
)99+ ,
{:: 
throw;; 
new;; 
IdMismatchException;; -
(;;- .
);;. /
;;;/ 0
}<< 
var>> 
record>> 
=>> 
await>> 
	_mediator>> (
.>>( )
Send>>) -
(>>- .
new>>. 1#
GetAppointmentByIdQuery>>2 I
{>>J K
Id>>L N
=>>O P
id>>Q S
}>>T U
)>>U V
;>>V W
if?? 
(?? 
record?? 
==?? 
null?? 
)?? 
{@@ 
throwAA 
newAA 
AppointmentNotFoundAA -
(AA- .
)AA. /
;AA/ 0
}BB 
varDD 
resultDD 
=DD 
awaitDD 
	_mediatorDD (
.DD( )
SendDD) -
(DD- .
commandDD. 5
)DD5 6
;DD6 7
returnEE 
	NoContentEE 
(EE 
)EE 
;EE 
}FF 	
[HH 	

HttpDeleteHH	 
(HH 
$strHH 
)HH 
]HH 
publicII 
asyncII 
TaskII 
<II 
IActionResultII '
>II' (
DeleteII) /
(II/ 0
GuidII0 4
idII5 7
)II7 8
{JJ 	
varLL 
patientLL 
=LL 
awaitLL 
	_mediatorLL  )
.LL) *
SendLL* .
(LL. /
newLL/ 2#
GetAppointmentByIdQueryLL3 J
{LLK L
IdLLM O
=LLP Q
idLLR T
}LLU V
)LLV W
;LLW X
ifMM 
(MM 
patientMM 
==MM 
nullMM 
)MM  
{NN 
throwOO 
newOO 
AppointmentNotFoundOO -
(OO- .
)OO. /
;OO/ 0
}PP 
awaitQQ 
	_mediatorQQ 
.QQ 
SendQQ  
(QQ  !
newQQ! $$
DeleteAppointmentCommandQQ% =
{QQ> ?
IdQQ@ B
=QQC D
idQQE G
}QQH I
)QQI J
;QQJ K
returnRR 
	NoContentRR 
(RR 
)RR 
;RR 
}SS 	
}TT 
}UU 